<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Random effect meta-analysis for correlated test statistics using RE2C"><title>Random effect meta-analysis for correlated test statistics — RE2C • remaCor</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Random effect meta-analysis for correlated test statistics — RE2C"><meta property="og:description" content="Random effect meta-analysis for correlated test statistics using RE2C"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">remaCor</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.10</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/remaCor.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/DiseaseNeurogenomics/remaCor/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Random effect meta-analysis for correlated test statistics</h1>
      <small class="dont-index">Source: <a href="https://github.com/DiseaseNeurogenomics/remaCor/blob/HEAD/R/RE2C.R" class="external-link"><code>R/RE2C.R</code></a></small>
      <div class="d-none name"><code>RE2C.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Random effect meta-analysis for correlated test statistics using RE2C</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">RE2C</span><span class="op">(</span><span class="va">beta</span>, <span class="va">stders</span>, cor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">beta</span><span class="op">)</span><span class="op">)</span>, twoStep <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>beta</dt>
<dd><p>regression coefficients from each analysis</p></dd>


<dt>stders</dt>
<dd><p>standard errors corresponding to betas</p></dd>


<dt>cor</dt>
<dd><p>correlation matrix between of test statistics.  Default considers uncorrelated test statistics</p></dd>


<dt>twoStep</dt>
<dd><p>Apply two step version of RE2C that is designed to be applied only after the fixed effect model.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>Return values:</p><ul><li><p><code>stat1</code>: statistic testing effect mean</p></li>
<li><p><code>stat2</code>: statistic testing effect heterogeneity</p></li>
<li><p><code>RE2Cp</code>: RE2 p-value accounting for correlelation between tests</p></li>
<li><p><code>RE2Cp.twoStep</code>: two step RE2C test after fixed effect test.  Only evaluated if twoStep==TRUE</p></li>
<li><p><code>QE</code>: test statistic for the test of (residual) heterogeneity</p></li>
<li><p><code>QEp</code>: p-value for the test of (residual) heterogeneity</p></li>
<li><p><code>Isq</code>: I^2 statistic</p></li>
</ul><p><code>QE</code>, <code>QEp</code> and <code>ISq</code> are only evaluted if correlation is diagonal</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Perform random effect meta-analysis for correlated test statistics using RE2 method of Han and Eskin (2011), or RE2 for correlated test statistics from Han, et al., (2016).  Also uses RE2C method of Lee, Eskin and Han (2017) to further test for heterogenity in effect size. By default, correlation is set to identity matrix to for independent test statistics.</p>
<p>This method requires the correlation matrix to be symmatric positive definite (SPD).  If this condition is not satisfied, results will be NA.  If the matrix is not SPD, there is likely an issue with how it was generated.</p>
<p>However, evaluating the correlation between observations that are not pairwise complete can give correlation matricies that are not SPD.  In this case, consider running <code>Matrix::nearPD( x, corr=TRUE)</code> to produce the nearest SPD matrix to the input.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Lee CH, Eskin E, Han B (2017).
“Increasing the power of meta-analysis of genome-wide association studies to detect heterogeneous effects.”
<em>Bioinformatics</em>, <b>33</b>(14), i379--i388.
<a href="https://doi.org/10.1093/bioinformatics/btx242" class="external-link">https://doi.org/10.1093/bioinformatics/btx242</a>.  Han B, Duong D, Sul JH, de Bakker PI, Eskin E, Raychaudhuri S (2016).
“A general framework for meta-analyzing dependent studies with overlapping subjects in association mapping.”
<em>Human Molecular Genetics</em>, <b>25</b>(9), 1857--1866.
<a href="https://doi.org/10.1093/hmg/ddw049" class="external-link">https://doi.org/10.1093/hmg/ddw049</a>.  Han B, Eskin E (2011).
“Random-effects model aimed at discovering associations in meta-analysis of genome-wide association studies.”
<em>The American Journal of Human Genetics</em>, <b>88</b>(5), 586--598.
<a href="https://doi.org/10.1016/j.ajhg.2011.04.014" class="external-link">https://doi.org/10.1016/j.ajhg.2011.04.014</a>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Generate effects</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://mvtnorm.R-forge.R-project.org" class="external-link">mvtnorm</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">clusterGeneration</span> <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">=</span> <span class="fl">4</span></span></span>
<span class="r-in"><span><span class="va">Sigma</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cov2cor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/clusterGeneration/man/genPositiveDefMat.html" class="external-link">genPositiveDefMat</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">$</span><span class="va">Sigma</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">beta</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">n</span><span class="op">)</span>, <span class="va">Sigma</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">stders</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">.1</span>, <span class="va">n</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Run fixed effects meta-analysis, </span></span></span>
<span class="r-in"><span><span class="co"># assume identity correlation  </span></span></span>
<span class="r-in"><span><span class="fu"><a href="LS.html">LS</a></span><span class="op">(</span> <span class="va">beta</span>, <span class="va">stders</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         beta   se          p</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 0.09877893 0.05 0.04820252</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Run random effects meta-analysis,</span></span></span>
<span class="r-in"><span><span class="co"># assume identity correlation  </span></span></span>
<span class="r-in"><span><span class="fu">RE2C</span><span class="op">(</span> <span class="va">beta</span>, <span class="va">stders</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      stat1    stat2        RE2Cp RE2Cp.twoStep       QE          QEp      Isq</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 3.902911 124.5332 4.031684e-29            NA 142.8348 9.250987e-31 97.89967</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Run fixed effects meta-analysis, </span></span></span>
<span class="r-in"><span><span class="co"># account for correlation </span></span></span>
<span class="r-in"><span><span class="fu"><a href="LS.html">LS</a></span><span class="op">(</span> <span class="va">beta</span>, <span class="va">stders</span>, <span class="va">Sigma</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        beta         se            p</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 0.1806549 0.03973155 5.444484e-06</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Run random effects meta-analysis,</span></span></span>
<span class="r-in"><span><span class="co"># account for correlation </span></span></span>
<span class="r-in"><span><span class="fu">RE2C</span><span class="op">(</span> <span class="va">beta</span>, <span class="va">stders</span>, <span class="va">Sigma</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      stat1    stat2       RE2Cp RE2Cp.twoStep QE QEp Isq</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 20.67419 117.2758 3.77186e-31            NA NA  NA  NA</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by <a href="http://gabrielhoffman.github.io" class="external-link">Gabriel Hoffman</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer></div>

  

  

  </body></html>

