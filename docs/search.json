[{"path":"http://gabrielhoffman.github.io/remaCor/articles/remaCor.html","id":"fixed-effects-meta-analysis","dir":"Articles","previous_headings":"","what":"Fixed effects meta-analysis","title":"Random effects meta-analysis for correlated test statistics","text":"LS() implements fixed effect meta-analysis correlated test statistics using method Lin Sullivan (2009). default, correlation set identity matrix independent test statistics.","code":""},{"path":"http://gabrielhoffman.github.io/remaCor/articles/remaCor.html","id":"random-effects-meta-analysis","dir":"Articles","previous_headings":"","what":"Random effects meta-analysis","title":"Random effects meta-analysis for correlated test statistics","text":"RE2C() implements random effect meta-analysis correlated test statistics jointly tests deviation mean zero well effect size heterogenity. method uses RE2 method Han Eskin (2011), RE2 correlated test statistics Han et al. (2016). default, correlation set identity matrix independent test statistics. (addition, function computes two step RE2C method Lee, Eskin, Han (2017) test heterogenity effect size applying fixed effect test.) stat1: statistic testing effect mean stat2: statistic testing effect heterogeneity RE2Cp: RE2 p-value accounting correlelation tests. (p-value appropriate questions) RE2Cp.twoStep: two step RE2C test fixed effect test. evaluated twoStep==TRUE. (typically used) QE: test statistic test (residual) heterogeneity QEp: p-value test (residual) heterogeneity Isq: ^2 statistic QE, QEp Isq evaluted correlation diagonal","code":""},{"path":"http://gabrielhoffman.github.io/remaCor/articles/remaCor.html","id":"examples","dir":"Articles","previous_headings":"","what":"Examples","title":"Random effects meta-analysis for correlated test statistics","text":"","code":"library(remaCor) library(metafor)  # Generate effects library(mvtnorm) library(clusterGeneration )  n = 4 Sigma = cov2cor(genPositiveDefMat(n)$Sigma) beta = t(rmvnorm(1, rep(0, n), Sigma)) stders = rep(.1, n)  # Standard fixed effects meta-analysis # of independent effects with metafor pacakge rma( beta, sei=stders, method=\"FE\") ##  ## Fixed-Effects Model (k = 4) ##  ## I^2 (total heterogeneity / total variability):   99.20% ## H^2 (total variability / sampling variability):  125.67 ##  ## Test for Heterogeneity: ## Q(df = 3) = 377.0118, p-val < .0001 ##  ## Model Results: ##  ## estimate      se    zval    pval   ci.lb   ci.ub       ##   0.2954  0.0500  5.9090  <.0001  0.1975  0.3934  ***  ##  ## --- ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 # Standard random effects meta-analysis # of independent effects with metafor pacakge rma( beta, sei=stders, method=\"REML\") ##  ## Random-Effects Model (k = 4; tau^2 estimator: REML) ##  ## tau^2 (estimated amount of total heterogeneity): 1.2467 (SE = 1.0261) ## tau (square root of estimated tau^2 value):      1.1166 ## I^2 (total heterogeneity / total variability):   99.20% ## H^2 (total variability / sampling variability):  125.67 ##  ## Test for Heterogeneity: ## Q(df = 3) = 377.0118, p-val < .0001 ##  ## Model Results: ##  ## estimate      se    zval    pval    ci.lb   ci.ub     ##   0.2954  0.5605  0.5271  0.5981  -0.8031  1.3940     ##  ## --- ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 # Run fixed effects meta-analysis, assume identity correlation   # Use Lin-Sullivan method LS( beta, stders) ##        beta   se          p ## 1 0.2954491 0.05 3.4423e-09 # Run fixed effects meta-analysis, accounting for correlation   # Use Lin-Sullivan method LS( beta, stders, Sigma) ##        beta         se            p ## 1 0.2204897 0.04701772 2.738701e-06 # Run random effects meta-analysis, assume identity correlation   RE2C( beta, stders) ##      stat1    stat2        RE2Cp RE2Cp.twoStep       QE          QEp      Isq ## 1 34.91606 354.8279 6.788274e-86            NA 377.0118 2.109551e-81 99.20427 # Run random effects meta-analysis, accounting for correlation  RE2C( beta, stders, Sigma) ##      stat1    stat2        RE2Cp RE2Cp.twoStep QE QEp Isq ## 1 21.99143 407.9481 1.366385e-94            NA NA  NA  NA ##      stat1    stat2        RE2Cp RE2Cp.twoStep QE QEp Isq ## 1 21.99143 407.9481 1.366385e-94            NA NA  NA  NA"},{"path":"http://gabrielhoffman.github.io/remaCor/articles/remaCor.html","id":"session-info","dir":"Articles","previous_headings":"","what":"Session info","title":"Random effects meta-analysis for correlated test statistics","text":"","code":"sessionInfo() ## R version 4.2.0 (2022-04-22) ## Platform: x86_64-apple-darwin19.6.0 (64-bit) ## Running under: macOS Catalina 10.15.7 ##  ## Matrix products: default ## BLAS:   /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libBLAS.dylib ## LAPACK: /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libLAPACK.dylib ##  ## locale: ## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8 ##  ## attached base packages: ## [1] grid      stats     graphics  grDevices utils     datasets  methods   ## [8] base      ##  ## other attached packages: ##  [1] mvtnorm_1.1-3           metafor_3.8-1           metadat_1.2-0           ##  [4] Matrix_1.4-1            remaCor_0.0.7           reshape2_1.4.4          ##  [7] ggplot2_3.3.6           clusterGeneration_1.3.7 MASS_7.3-58.1           ## [10] RUnit_0.4.32            ##  ## loaded via a namespace (and not attached): ##  [1] tidyselect_1.1.2  xfun_0.32         bslib_0.4.0       purrr_0.3.4       ##  [5] lattice_0.20-45   colorspace_2.0-3  vctrs_0.4.1       generics_0.1.3    ##  [9] htmltools_0.5.3   yaml_2.3.5        utf8_1.2.2        rlang_1.0.5       ## [13] pkgdown_2.0.6     jquerylib_0.1.4   pillar_1.8.1      glue_1.6.2        ## [17] withr_2.5.0       DBI_1.1.3         lifecycle_1.0.1   plyr_1.8.7        ## [21] stringr_1.4.1     munsell_0.5.0     gtable_0.3.1      ragg_1.2.2        ## [25] codetools_0.2-18  memoise_2.0.1     evaluate_0.16     knitr_1.40        ## [29] fastmap_1.1.0     fansi_1.0.3       Rcpp_1.0.9        scales_1.2.1      ## [33] cachem_1.0.6      desc_1.4.1        jsonlite_1.8.0    systemfonts_1.0.4 ## [37] fs_1.5.2          textshaping_0.3.6 digest_0.6.29     stringi_1.7.8     ## [41] dplyr_1.0.9       mathjaxr_1.6-0    rbibutils_2.2.9   rprojroot_2.0.3   ## [45] Rdpack_2.4        cli_3.3.0         tools_4.2.0       magrittr_2.0.3    ## [49] sass_0.4.2        tibble_3.1.8      pkgconfig_2.0.3   assertthat_0.2.1  ## [53] rmarkdown_2.16    R6_2.5.1          nlme_3.1-159      compiler_4.2.0"},{"path":[]},{"path":"http://gabrielhoffman.github.io/remaCor/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Gabriel Hoffman. Author, maintainer.","code":""},{"path":"http://gabrielhoffman.github.io/remaCor/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Lee, C. H., Eskin, E., & Han, B. (2017). Increasing power meta-analysis genome-wide association studies detect heterogeneous effects. Bioinformatics, 33(14), i379-i388. doi:10.1093/bioinformatics/btx242 Han, B. et al. (2016) general framework meta-analyzing dependent studies overlapping subjects association mapping. Hum. Mol. Genet., 25, 1857-1866. Han, B. Eskin, E. (2011) Random-effects model aimed discovering associations meta-analysis genome-wide association studies. . J. Hum. Genet., 88, 586-598. doi:10.1016/j.ajhg.2011.04.014","code":"@Article{,   title = {Increasing the power of meta-analysis of genome-wide association studies to detect heterogeneous effects},   author = {CH Lee and Eleazar Eskin and Buhm Han},   year = {2017},   journal = {Bioinformatics},   doi = {10.1093/bioinformatics/btx242},   volume = {33},   issue = {14},   pages = {i379--i388}, } @Article{,   title = {A general framework for meta-analyzing dependent studies with overlapping subjects in association mapping},   author = {Buhm Han and et al.},   year = {2016},   journal = {Hum. Mol. Genet.},   doi = {10.1093/hmg/ddw049},   volume = {25},   issue = {9},   pages = {1857-1866}, } @Article{,   title = {Random-effects model aimed at discovering associations in meta-analysis of genome-wide association studies},   author = {Buhm Han and Eleazar Eskin},   year = {2011},   journal = {Am. J. Hum. Genet.},   doi = {10.1016/j.ajhg.2011.04.014},   volume = {88},   issue = {5},   pages = {586--598}, }"},{"path":"http://gabrielhoffman.github.io/remaCor/index.html","id":"random-effects-meta-analysis-for-correlated-test-statistics","dir":"","previous_headings":"","what":"Random Effects Meta-Analysis for Correlated Test Statistics","title":"Random Effects Meta-Analysis for Correlated Test Statistics","text":"Meta-analysis widely used summarize estimated effects sizes across multiple statistical tests. Standard fixed random effect meta-analysis methods assume estimated effect sizes statistically independent. relax assumption enable meta-analysis correlation matrix effect size estimates known. Fixed effect meta-analysis uses method Lin Sullivan (2009), random effects meta-analysis uses method Han, et al. 2016.","code":""},{"path":"http://gabrielhoffman.github.io/remaCor/index.html","id":"usage","dir":"","previous_headings":"","what":"Usage","title":"Random Effects Meta-Analysis for Correlated Test Statistics","text":"","code":"# Run fixed effects meta-analysis, accounting for correlation  LS( beta, stders, Sigma)  # Run random effects meta-analysis, accounting for correlation  RE2C( beta, stders, Sigma)"},{"path":"http://gabrielhoffman.github.io/remaCor/index.html","id":"install-from-github","dir":"","previous_headings":"","what":"Install from GitHub","title":"Random Effects Meta-Analysis for Correlated Test Statistics","text":"","code":"devtools::install_github(\"GabrielHoffman/remaCor\")"},{"path":"http://gabrielhoffman.github.io/remaCor/reference/LS.html","id":null,"dir":"Reference","previous_headings":"","what":"Fixed effect meta-analysis for correlated test statistics — LS","title":"Fixed effect meta-analysis for correlated test statistics — LS","text":"Fixed effect meta-analysis correlated test statistics using Lin-Sullivan method.","code":""},{"path":"http://gabrielhoffman.github.io/remaCor/reference/LS.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fixed effect meta-analysis for correlated test statistics — LS","text":"","code":"LS(beta, stders, cor = diag(1, length(beta)))"},{"path":"http://gabrielhoffman.github.io/remaCor/reference/LS.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fixed effect meta-analysis for correlated test statistics — LS","text":"beta regression coefficients analysis stders standard errors corresponding betas cor correlation matrix test statistics.  Default considers uncorrelated test statistics","code":""},{"path":"http://gabrielhoffman.github.io/remaCor/reference/LS.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fixed effect meta-analysis for correlated test statistics — LS","text":"Return values: beta: effect size se: effect size standard error p: p-value","code":""},{"path":"http://gabrielhoffman.github.io/remaCor/reference/LS.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Fixed effect meta-analysis for correlated test statistics — LS","text":"Perform fixed effect meta-analysis correlated test statistics using method Lin Sullivan (2009).  default, correlation set identity matrix independent test statistics. method requires correlation matrix symmatric positive definite (SPD).  condition satisfied, results NA.  matrix SPD, likely issue generated. However, evaluating correlation observations pairwise complete can give correlation matricies SPD.  case, consider running Matrix::nearPD( x, corr=TRUE) produce nearest SPD matrix input.","code":""},{"path":"http://gabrielhoffman.github.io/remaCor/reference/LS.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Fixed effect meta-analysis for correlated test statistics — LS","text":"Lin D, Sullivan PF (2009). “Meta-analysis genome-wide association studies overlapping subjects.” American Journal Human Genetics, 85(6), 862--872. https://doi.org/10.1016/j.ajhg.2009.11.001.","code":""},{"path":"http://gabrielhoffman.github.io/remaCor/reference/LS.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Fixed effect meta-analysis for correlated test statistics — LS","text":"","code":"# Generate effects library(mvtnorm) library(clusterGeneration )  n = 4 Sigma = cov2cor(genPositiveDefMat(n)$Sigma) beta = t(rmvnorm(1, rep(0, n), Sigma)) stders = rep(.1, n)  # Run fixed effects meta-analysis,  # assume identity correlation   LS( beta, stders) #>        beta   se            p #> 1 0.4272918 0.05 1.276098e-17  # Run random effects meta-analysis, # assume identity correlation   RE2C( beta, stders) #>     stat1    stat2         RE2Cp RE2Cp.twoStep       QE          QEp      Isq #> 1 73.0313 402.6386 1.475558e-104            NA 425.3046 7.304323e-92 99.29462  # Run fixed effects meta-analysis,  # account for correlation  LS( beta, stders, Sigma) #>       beta         se            p #> 1 0.328416 0.05825681 1.726534e-08  # Run random effects meta-analysis, # account for correlation  RE2C( beta, stders, Sigma) #>      stat1    stat2         RE2Cp RE2Cp.twoStep QE QEp Isq #> 1 31.78009 466.6195 1.938984e-109            NA NA  NA  NA"},{"path":"http://gabrielhoffman.github.io/remaCor/reference/RE2C.html","id":null,"dir":"Reference","previous_headings":"","what":"Random effect meta-analysis for correlated test statistics — RE2C","title":"Random effect meta-analysis for correlated test statistics — RE2C","text":"Random effect meta-analysis correlated test statistics using RE2C","code":""},{"path":"http://gabrielhoffman.github.io/remaCor/reference/RE2C.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Random effect meta-analysis for correlated test statistics — RE2C","text":"","code":"RE2C(beta, stders, cor = diag(1, length(beta)), twoStep = FALSE)"},{"path":"http://gabrielhoffman.github.io/remaCor/reference/RE2C.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Random effect meta-analysis for correlated test statistics — RE2C","text":"beta regression coefficients analysis stders standard errors corresponding betas cor correlation matrix test statistics.  Default considers uncorrelated test statistics twoStep Apply two step version RE2C designed applied fixed effect model.","code":""},{"path":"http://gabrielhoffman.github.io/remaCor/reference/RE2C.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Random effect meta-analysis for correlated test statistics — RE2C","text":"Return values: stat1: statistic testing effect mean stat2: statistic testing effect heterogeneity RE2Cp: RE2 p-value accounting correlelation tests RE2Cp.twoStep: two step RE2C test fixed effect test.  evaluated twoStep==TRUE QE: test statistic test (residual) heterogeneity QEp: p-value test (residual) heterogeneity Isq: ^2 statistic QE, QEp ISq evaluted correlation diagonal","code":""},{"path":"http://gabrielhoffman.github.io/remaCor/reference/RE2C.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Random effect meta-analysis for correlated test statistics — RE2C","text":"Perform random effect meta-analysis correlated test statistics using RE2 method Han Eskin (2011), RE2 correlated test statistics Han, et al., (2016).  Also uses RE2C method Lee, Eskin Han (2017) test heterogenity effect size. default, correlation set identity matrix independent test statistics. method requires correlation matrix symmatric positive definite (SPD).  condition satisfied, results NA.  matrix SPD, likely issue generated. However, evaluating correlation observations pairwise complete can give correlation matricies SPD.  case, consider running Matrix::nearPD( x, corr=TRUE) produce nearest SPD matrix input.","code":""},{"path":"http://gabrielhoffman.github.io/remaCor/reference/RE2C.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Random effect meta-analysis for correlated test statistics — RE2C","text":"Lee CH, Eskin E, Han B (2017). “Increasing power meta-analysis genome-wide association studies detect heterogeneous effects.” Bioinformatics, 33(14), i379--i388. https://doi.org/10.1093/bioinformatics/btx242.  Han B, Duong D, Sul JH, de Bakker PI, Eskin E, Raychaudhuri S (2016). “general framework meta-analyzing dependent studies overlapping subjects association mapping.” Human Molecular Genetics, 25(9), 1857--1866. https://doi.org/10.1093/hmg/ddw049.  Han B, Eskin E (2011). “Random-effects model aimed discovering associations meta-analysis genome-wide association studies.” American Journal Human Genetics, 88(5), 586--598. https://doi.org/10.1016/j.ajhg.2011.04.014.","code":""},{"path":"http://gabrielhoffman.github.io/remaCor/reference/RE2C.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Random effect meta-analysis for correlated test statistics — RE2C","text":"","code":"# Generate effects library(mvtnorm) library(clusterGeneration )  set.seed(1) n = 4 Sigma = cov2cor(genPositiveDefMat(n)$Sigma) beta = t(rmvnorm(1, rep(0, n), Sigma)) stders = rep(.1, n)  # Run fixed effects meta-analysis,  # assume identity correlation   LS( beta, stders) #>         beta   se          p #> 1 0.09877893 0.05 0.04820252  # Run random effects meta-analysis, # assume identity correlation   RE2C( beta, stders) #>      stat1    stat2        RE2Cp RE2Cp.twoStep       QE          QEp      Isq #> 1 3.902911 124.5332 4.031684e-29            NA 142.8348 9.250987e-31 97.89967  # Run fixed effects meta-analysis,  # account for correlation  LS( beta, stders, Sigma) #>        beta         se            p #> 1 0.1806549 0.03973155 5.444484e-06  # Run random effects meta-analysis, # account for correlation  RE2C( beta, stders, Sigma) #>      stat1    stat2       RE2Cp RE2Cp.twoStep QE QEp Isq #> 1 20.67419 117.2758 3.77186e-31            NA NA  NA  NA"},{"path":"http://gabrielhoffman.github.io/remaCor/reference/pkg.env.html","id":null,"dir":"Reference","previous_headings":"","what":"Local environment — pkg.env","title":"Local environment — pkg.env","text":"Local environment","code":""},{"path":"http://gabrielhoffman.github.io/remaCor/reference/pkg.env.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Local environment — pkg.env","text":"","code":"pkg.env"},{"path":"http://gabrielhoffman.github.io/remaCor/reference/pkg.env.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Local environment — pkg.env","text":"object class environment length 0.","code":""},{"path":"http://gabrielhoffman.github.io/remaCor/reference/plotCor.html","id":null,"dir":"Reference","previous_headings":"","what":"Correlation plot — plotCor","title":"Correlation plot — plotCor","text":"Correlation plot","code":""},{"path":"http://gabrielhoffman.github.io/remaCor/reference/plotCor.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Correlation plot — plotCor","text":"","code":"plotCor(cor)"},{"path":"http://gabrielhoffman.github.io/remaCor/reference/plotCor.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Correlation plot — plotCor","text":"cor correlation matrix test statistics.  Default considers uncorrelated test statistics","code":""},{"path":"http://gabrielhoffman.github.io/remaCor/reference/plotCor.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Correlation plot — plotCor","text":"Plot correlation matrix","code":""},{"path":"http://gabrielhoffman.github.io/remaCor/reference/plotCor.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Correlation plot — plotCor","text":"","code":"# Generate effects library(mvtnorm) library(clusterGeneration )  n = 4 Sigma = cov2cor(genPositiveDefMat(n)$Sigma) beta = t(rmvnorm(1, rep(0, n), Sigma)) stders = rep(.1, n)    # set names rownames(Sigma) = colnames(Sigma) = LETTERS[1:n] rownames(beta) = names(stders) = LETTERS[1:n]  # Run random effects meta-analysis, # account for correlation  RE2C( beta, stders, Sigma) #>      stat1    stat2         RE2Cp RE2Cp.twoStep QE QEp Isq #> 1 98.67579 533.4688 1.583229e-138            NA NA  NA  NA  # Make plot plotCor( Sigma )"},{"path":"http://gabrielhoffman.github.io/remaCor/reference/plotForest.html","id":null,"dir":"Reference","previous_headings":"","what":"Forest plot of coefficients — plotForest","title":"Forest plot of coefficients — plotForest","text":"Forest plot coefficients","code":""},{"path":"http://gabrielhoffman.github.io/remaCor/reference/plotForest.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Forest plot of coefficients — plotForest","text":"","code":"plotForest(beta, stders)"},{"path":"http://gabrielhoffman.github.io/remaCor/reference/plotForest.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Forest plot of coefficients — plotForest","text":"beta regression coefficients analysis stders standard errors corresponding betas","code":""},{"path":"http://gabrielhoffman.github.io/remaCor/reference/plotForest.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Forest plot of coefficients — plotForest","text":"Forest plot effect sizes standard errors","code":""},{"path":"http://gabrielhoffman.github.io/remaCor/reference/plotForest.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Forest plot of coefficients — plotForest","text":"","code":"# Generate effects library(mvtnorm) library(clusterGeneration )  n = 4 Sigma = cov2cor(genPositiveDefMat(n)$Sigma) beta = t(rmvnorm(1, rep(0, n), Sigma)) stders = rep(.1, n)    # set names rownames(Sigma) = colnames(Sigma) = LETTERS[1:n] rownames(beta) = names(stders) = LETTERS[1:n]  # Run random effects meta-analysis, # account for correlation  RE2C( beta, stders, Sigma) #>      stat1   stat2         RE2Cp RE2Cp.twoStep QE QEp Isq #> 1 1.595871 516.491 9.729461e-114            NA NA  NA  NA  # Make plot plotForest( beta, stders )"}]
